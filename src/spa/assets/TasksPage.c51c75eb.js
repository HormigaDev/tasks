import{l as ie,c as H,h as z,m as ne,aC as de,ac as he,r as c,aD as pe,aE as fe,w as W,o as ee,U as q,Q as _,g as ke,aB as ve,_ as te,q as ue,I as m,J as $,M as y,j as o,F as E,V as j,K as l,aF as ce,L as g,aG as se,O as v,S as P,P as b,aH as Z,aI as S,N as x,D as R,aJ as G,X as ae,aK as Y,aL as ye,d as be,H as J}from"./index.b0e7c966.js";import{Q as we}from"./QPage.961fbc78.js";import{E as U,u as X}from"./EventBus.0832b019.js";import{Q as oe,a as B}from"./QSelect.de34ea6a.js";import{a as O,Q as N}from"./QItem.6a2a9afc.js";import{a as me,Q as _e}from"./QList.d01e1cca.js";import{Q as Ce}from"./format.dc8d63aa.js";import{Q as qe}from"./QPagination.130d3e16.js";import{C as K}from"./ClosePopup.7af05622.js";import{g as L,a as le,d as xe,e as re,n as Te,b as Be,c as Ve,N as Se,T as Qe}from"./TaskComponent.778ee127.js";import{s as F}from"./virtualStorage.fcd16839.js";import{L as ge}from"./utils.255e6c27.js";import{Q as Ue}from"./QBanner.149ef946.js";import"./QDate.0fd01da1.js";import"./date.9911f11f.js";import"./QForm.c103ec47.js";import"./API.cd016945.js";import"./configs.0e8d95c2.js";var Ie=ie({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:a}){const d=H(()=>{const h=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(t=>e[t]===!0).map(t=>`q-btn-group--${t}`).join(" ");return`q-btn-group row no-wrap${h.length!==0?" "+h:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>z("div",{class:d.value},ne(a.default))}});const De=Object.keys(de),$e=e=>De.reduce((a,d)=>{const h=e[d];return h!==void 0&&(a[d]=h),a},{});var Ae=ie({name:"QBtnDropdown",props:{...de,...he,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:a,emit:d}){const{proxy:h}=ke(),t=c(e.modelValue),n=c(null),s=pe(),i=H(()=>{const u={"aria-expanded":t.value===!0?"true":"false","aria-haspopup":"true","aria-controls":s.value,"aria-label":e.toggleAriaLabel||h.$q.lang.label[t.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(u["aria-disabled"]="true"),u}),p=H(()=>"q-btn-dropdown__arrow"+(t.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),C=H(()=>fe(e)),w=H(()=>$e(e));W(()=>e.modelValue,u=>{n.value!==null&&n.value[u?"show":"hide"]()}),W(()=>e.split,A);function I(u){t.value=!0,d("beforeShow",u)}function Q(u){d("show",u),d("update:modelValue",!0)}function D(u){t.value=!1,d("beforeHide",u)}function f(u){d("hide",u),d("update:modelValue",!1)}function r(u){d("click",u)}function k(u){ve(u),A(),d("click",u)}function T(u){n.value!==null&&n.value.toggle(u)}function V(u){n.value!==null&&n.value.show(u)}function A(u){n.value!==null&&n.value.hide(u)}return Object.assign(h,{show:V,hide:A,toggle:T}),ee(()=>{e.modelValue===!0&&V()}),()=>{const u=[z(q,{class:p.value,name:e.dropdownIcon||h.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&u.push(z(Ce,{ref:n,id:s.value,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:I,onShow:Q,onBeforeHide:D,onHide:f},a.default)),e.split===!1?z(_,{class:"q-btn-dropdown q-btn-dropdown--simple",...w.value,...i.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:r},{default:()=>ne(a.label,[]).concat(u),loading:a.loading}):z(Ie,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...C.value,glossy:e.glossy,stretch:e.stretch},()=>[z(_,{class:"q-btn-dropdown--current",...w.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:k},{default:a.label,loading:a.loading}),z(_,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...i.value,...C.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>u)])}}}),ze=[{name:"description",align:"center",label:"Description",field:"description",sortable:!0},{name:"categories",label:"Categories",field:"categories",sortable:!1},{name:"priority",label:"Priority",field:"priority",sortable:!0}];const Fe={name:"QuasarTableComponent",data(){var C,w,I,Q,D,f;const e=c(F.get("theme")),a={urgent:{color:"#f22",name:this.$t("pages.tasks.inputs.options.priorities.urgent"),icon:"error"},high:{color:"#ff6",name:this.$t("pages.tasks.inputs.options.priorities.high"),icon:"warning"},normal:{color:"#66f",name:this.$t("pages.tasks.inputs.options.priorities.normal")},low:{color:"#6f6",name:this.$t("pages.tasks.inputs.options.priorities.low")}},d=c([]),h=c([]),t=c({priority:{label:(C=localStorage.getItem("default_priority"))!=null?C:this.$t("pages.tasks.inputs.options.priorities.all"),value:(w=localStorage.getItem("default_priority_value"))!=null?w:0},order_by:{label:(I=localStorage.getItem("default_order_by"))!=null?I:this.$t("pages.tasks.inputs.options.orders_by.run_date"),value:(Q=localStorage.getItem("default_order_by_value"))!=null?Q:"run_date"},asc_desc:{label:(D=localStorage.getItem("default_asc_desc"))!=null?D:this.$t("pages.tasks.inputs.options.orders.asc"),value:(f=localStorage.getItem("default_asc_desc_value"))!=null?f:"asc"},page:1,categories:[],limit:10,search:"",fixed:!1,showArchives:!1,showEndeds:!1}),n=c(0);ee(()=>{L().then(({data:r,status:k})=>{if(k===200){const T=r.categories.map(V=>({label:V.name,value:V.id}));h.value=T}})});const s=async()=>{le(t.value.page,t.value.limit,[],t.value.search,t.value.order_by.value,t.value.asc_desc.value,t.value.priority.value,t.value.fixed,t.value.showArchives,t.value.showEndeds).then(({data:r,status:k})=>{var T;k===200?(r.tasks=r.tasks.map(V=>{let[A,u,M]=V.runDate.split("-");return V.isoDate=`${M}/${u}/${A}`,[A,u,M]=V.createdAt.split("-"),M=M.split(" ")[0],V.isoCreatedAt=`${M}/${u}/${A}`,V}),d.value=r.tasks,n.value=(T=r.total)!=null?T:0):k===404&&(d.value=[])})},i=new ge(()=>{e.value=F.get("theme"),s()});i.start();//!! dimounting component
U.on("task-added",()=>{le(t.value.page,t.value.limit,t.value.categories.map(r=>r.id),t.value.search,t.value.order_by.value,t.value.asc_desc.value,t.value.priority.value).then(({data:r,status:k})=>{k===200&&(d.value=r.tasks)})}),U.on("show-fixed-tasks",()=>{t.value.fixed=!t.value.fixed,s()}),U.on("filter-by-category",r=>{t.value.categories=[r],s()}),U.on("task-updated",()=>{s()}),ue(()=>{i.stop(),U.off("task-added"),U.off("show-fixed-tasks"),U.off("filter-by-category"),U.off("task-updated")});const p=X();return{theme:e,pagination:c(1),filter:c(""),selected:c([]),columns:ze,rows:d,originalRows:c(d),categories:h,priorities:a,filterBarOptions:[{label:this.$t("pages.tasks.inputs.labels.priority"),value:"priority",options:[{label:this.$t("pages.tasks.inputs.options.priorities.all"),value:0},{label:this.$t("pages.tasks.inputs.options.priorities.urgent"),value:4},{label:this.$t("pages.tasks.inputs.options.priorities.high"),value:3},{label:this.$t("pages.tasks.inputs.options.priorities.normal"),value:2},{label:this.$t("pages.tasks.inputs.options.priorities.low"),value:1}]},{label:this.$t("pages.tasks.inputs.labels.order_by"),value:"order_by",options:[{label:this.$t("pages.tasks.inputs.options.orders_by.run_date"),value:"run_date"},{label:this.$t("pages.tasks.inputs.options.orders_by.created_at"),value:"created_at"},{label:this.$t("pages.tasks.inputs.options.orders_by.title"),value:"title"},{label:this.$t("pages.tasks.inputs.options.orders_by.description"),value:"description"}]},{label:this.$t("pages.tasks.inputs.labels.order"),value:"asc_desc",options:[{label:this.$t("pages.tasks.inputs.options.orders.asc"),value:"asc"},{label:this.$t("pages.tasks.inputs.options.orders.desc"),value:"desc"}]}],filters:t,totalTasks:n,actualizeTasks:s,rowsPerPage:c(10),rowsPerPageOptions:[10,20,30,50,100],confirmDelete:(r,k)=>{p.dialog({title:this.$t("pages.tasks.titles.confirm_deletion"),message:this.$t("pages.tasks.messages.confirm_delete"),cancel:{label:this.$t("pages.tasks.buttons.cancel"),color:"grey-8"},persistent:!0,color:"red-5",dark:e.value==="dark",ok:{label:this.$t("pages.tasks.buttons.delete")}}).onOk(()=>{r(k)}).onCancel(()=>{})}}},methods:{newCategory(){this.$emit("update:newcategory",!0)},newTask(){let e=new Date;e=`${e.getFullYear()}-${("0"+(e.getMonth()+1)).slice(-2)}-${("0"+e.getDate()).slice(-2)}`,console.log(e),F.set("current_date",e),this.$emit("update:newtask",!0)},deleteTask(e){e&&this.confirmDelete(this.confirm,e)},confirm(e){xe(e).then(({status:a})=>{a===200&&this.$q.notify({message:this.$t("pages.tasks.messages.task_deleted"),color:"green-5",position:"bottom-right",timeout:2e3})}).catch(a=>{console.log(a),this.$q.notify({message:this.$t("pages.tasks.messages.error_deleting_task"),color:"red-5",position:"bottom-right",timeout:2e3})})},archiveTask(e,a="archived"){e&&re(e,{status:a}).then(({data:d,status:h})=>{h===200&&this.$q.notify({message:this.$t(`pages.tasks.messages.task_${a==="archived"?"archived":"unarchived"}`),color:"green-5",position:"bottom-right",timeout:2e3})})},showTask(e){this.$emit("update:showtask",e)},filterTasks(){localStorage.setItem("default_priority",this.filters.priority.label),localStorage.setItem("default_priority_value",this.filters.priority.value),localStorage.setItem("default_order_by",this.filters.order_by.label),localStorage.setItem("default_order_by_value",this.filters.order_by.value),localStorage.setItem("default_asc_desc",this.filters.asc_desc.label),localStorage.setItem("default_asc_desc_value",this.filters.asc_desc.value),this.actualizeTasks()},assingTask(e,a){re(e,{fixed:a}).then(({status:d})=>{d===200&&this.$q.notify({message:a?this.$t("pages.tasks.messages.task_assigned"):this.$t("pages.tasks.messages.task_unassigned"),color:"green-5",position:"bottom-right",timeout:2e3})}).catch(d=>{console.log(d)})}}},Pe={class:"q-pa-md"},Ne={class:"flex row"},Me={class:"flex row flex-center"},He={class:"q-mr-md flex row flex-center"},Oe={class:"q-mt-md"},Le={key:0,class:"absolute-top-left flex flex-center",style:{width:"100%",height:"100%"}},Ee=y("i",{class:"fa fa-thumbtack",style:{transform:"rotate(45deg)"}},null,-1),je=y("i",{class:"fa fa-thumbtack absolute-top-left",style:{transform:"rotate(45deg)"}},null,-1),Re={class:"flex flex-center"};function Ge(e,a,d,h,t,n){return m(),$("div",Pe,[y("div",Ne,[y("div",Me,[o(_,{dense:"",dark:t.theme==="dark",color:"grey-8",icon:"add",class:"q-ml-md q-mb-sm",onClick:n.newTask},null,8,["dark","onClick"]),o(_,{dense:"",dark:t.theme==="dark",color:"grey-8",icon:"category",class:"q-ml-md q-mb-sm",onClick:n.newCategory},null,8,["dark","onClick"]),y("div",He,[(m(!0),$(E,null,j(t.filterBarOptions,(s,i)=>(m(),b(oe,{outlined:"",dark:t.theme==="dark",key:i,modelValue:t.filters[s.value],"onUpdate:modelValue":[p=>t.filters[s.value]=p,n.filterTasks],options:s.options,label:s.label,class:"t-select q-ml-md v-tasks q-mb-sm",color:t.theme==="dark"?"white":"dark",dense:"","label-color":t.theme==="dark"?"grey-7":"grey-9",style:Z("width: "+i==1?170:70+"px")},null,8,["dark","modelValue","onUpdate:modelValue","options","label","color","label-color","style"]))),128))]),o(ce,{dense:"",dark:t.theme==="dark",outlined:"",color:t.theme==="dark"?"white":"dark",debounce:"200",modelValue:t.filters.search,"onUpdate:modelValue":[a[0]||(a[0]=s=>t.filters.search=s),n.filterTasks],placeholder:e.$t("pages.tasks.inputs.labels.search_task"),class:"q-mr-md q-mb-sm","label-color":t.theme==="dark"?"grey-7":"grey-9"},{append:l(()=>[o(q,{name:"search"})]),_:1},8,["dark","color","modelValue","placeholder","onUpdate:modelValue","label-color"])])]),y("div",Oe,[o(se,{dark:t.theme==="dark",color:t.theme==="dark"?"grey-7":"grey-9",modelValue:t.filters.showArchives,"onUpdate:modelValue":[a[1]||(a[1]=s=>t.filters.showArchives=s),n.filterTasks],label:e.$t("pages.tasks.inputs.labels.show_archiveds"),dense:"",class:g({"text-dark":t.theme!=="dark"})},null,8,["dark","color","modelValue","label","class","onUpdate:modelValue"]),o(se,{dark:t.theme==="dark",color:t.theme==="dark"?"grey-7":"grey-9",modelValue:t.filters.showEndeds,"onUpdate:modelValue":[a[2]||(a[2]=s=>t.filters.showEndeds=s),n.filterTasks],label:e.$t("pages.tasks.inputs.labels.show_finalizeds"),dense:"",class:g({"q-ml-xl":!0,"text-dark":t.theme!=="dark"})},null,8,["dark","color","modelValue","label","class","onUpdate:modelValue"])]),y("div",{style:{height:"58vh",overflow:"auto",position:"relative"},class:g({"tasks-grid":!0,"q-pl-md":!0,"q-pr-md":!0,"t-light":t.theme!=="dark"})},[t.rows.length===0?(m(),$("div",Le,[y("div",{class:g({"text-h4":!0,"text-grey-7":t.theme==="dark","text-grey-6":t.theme!=="dark"})},v(e.$t("pages.tasks.titles.nothing_to_show")),3)])):P("",!0),(m(!0),$(E,null,j(t.rows,s=>(m(),$("div",{key:s.id,style:{position:"relative",height:"320px",width:"100%"},class:g({"q-mt-md":!0,"q-mb-sm":!0,flex:!0,"flex-center":!0})},[o(Y,{dark:t.theme==="dark",class:g(t.theme==="dark"?"bg-grey-10":"bg-grey-5"),style:{height:"100%",width:"100%"}},{default:l(()=>[o(S,{class:g({"bg-grey-8":t.theme==="dark","bg-grey-6":t.theme!=="dark",row:!0})},{default:l(()=>[o(B,{style:{"font-size":"13px"},onClick:i=>n.showTask(s),class:"cursor-pointer"},{default:l(()=>[x(v(s.title.length>40?s.title.substring(0,40)+"...":s.title),1)]),_:2},1032,["onClick"]),s.fixed&&s.status!=="ended"?(m(),b(_,{key:0,flat:"",color:t.theme==="dark"?"grey-5":"grey-8",dense:"",rounded:"",class:g({"absolute-top-right q-mt-sm cursor-pointer":!0,"task-archived":s.status==="archived"}),style:{"margin-right":"40px"},onClick:i=>n.assingTask(s.id,!s.fixed)},{default:l(()=>[o(q,null,{default:l(()=>[Ee]),_:1})]),_:2},1032,["color","class","onClick"])):P("",!0),s.status==="archived"?(m(),b(_,{key:1,flat:"",color:t.theme==="dark"?"grey-4":"grey-8",dense:"",rounded:"",class:"absolute-top-right q-mt-sm",style:{"margin-right":"40px"},onClick:i=>n.archiveTask(s.id,"created")},{default:l(()=>[o(q,{name:"unarchive"})]),_:2},1032,["color","onClick"])):P("",!0),s.status==="ended"?(m(),b(_,{key:2,flat:"",color:"green-5",dense:"",rounded:"",class:"absolute-top-right q-mt-sm",style:{"margin-right":"40px","pointer-events":"none"}},{default:l(()=>[o(q,{name:"check"})]),_:1})):P("",!0),o(Ae,{class:g({"absolute-top-right q-mr-xs q-mt-sm":!0,"task-archived":s.status==="archived"}),flat:"",dense:"",rounded:"",color:t.theme==="dark"?"grey-5":"grey-8","dropdown-icon":"more_vert"},{default:l(()=>[o(me,null,{default:l(()=>[R((m(),b(O,{clickable:"",dark:t.theme==="dark",onClick:i=>n.showTask(s),class:g(t.theme==="dark"?"bg-grey-9":"bg-grey-6")},{default:l(()=>[o(N,null,{default:l(()=>[o(B,null,{default:l(()=>[o(q,{name:"visibility",color:t.theme==="dark"?"grey-5":"grey-9",class:"q-mr-md",size:"sm"},null,8,["color"]),x(v(e.$t("pages.tasks.titles.view_task")),1)]),_:1})]),_:1})]),_:2},1032,["dark","onClick","class"])),[[G],[K]]),R((m(),b(O,{dark:t.theme==="dark",clickable:"",onClick:i=>n.archiveTask(s.id),class:g(t.theme==="dark"?"bg-grey-9":"bg-grey-6")},{default:l(()=>[o(N,null,{default:l(()=>[o(B,null,{default:l(()=>[o(q,{name:"archive",color:t.theme==="dark"?"grey-5":"grey-9",class:"q-mr-md",size:"sm"},null,8,["color"]),x(v(e.$t("pages.tasks.titles.archive")),1)]),_:1})]),_:1})]),_:2},1032,["dark","onClick","class"])),[[G],[K]]),R((m(),b(O,{dark:t.theme==="dark",clickable:"",onClick:i=>n.assingTask(s.id,!s.fixed),class:g(t.theme==="dark"?"bg-grey-9":"bg-grey-6")},{default:l(()=>[o(N,null,{default:l(()=>[o(B,null,{default:l(()=>[o(q,{name:"keep_on",color:t.theme==="dark"?"grey-5":"grey-9",class:"q-mr-md",size:"sm"},{default:l(()=>[je]),_:1},8,["color"]),x(v(s.fixed?e.$t("pages.tasks.titles.unassign_task"):e.$t("pages.tasks.titles.assign_task")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["dark","onClick","class"])),[[G],[K]]),R((m(),b(O,{dark:t.theme==="dark",clickable:"",onClick:i=>n.deleteTask(s.id),class:g(t.theme==="dark"?"bg-grey-9":"bg-grey-6")},{default:l(()=>[o(N,null,{default:l(()=>[o(B,{class:"text-red-5"},{default:l(()=>[o(q,{name:"delete",color:"red-5",class:"q-mr-md",size:"sm"}),x(v(e.$t("pages.tasks.titles.delete")),1)]),_:1})]),_:1})]),_:2},1032,["dark","onClick","class"])),[[G],[K]])]),_:2},1024)]),_:2},1032,["class","color"])]),_:2},1032,["class"]),o(ae,{dark:t.theme==="dark"},null,8,["dark"]),o(S,{class:g({"flex row":!0,"task-archived":s.status==="archived"})},{default:l(()=>[y("div",{class:g({"q-mr-sm":!0,"text-dark":t.theme!=="dark"})},v(e.$t("pages.tasks.titles.categories"))+": ",3),(m(!0),$(E,null,j(s.categories.slice(0,3),i=>(m(),b(_e,{key:i.id,label:i.name,style:Z("background-color: #"+i.color+" !important"),class:"q-mr-xs",dense:""},{default:l(()=>[o(q,{name:i.icon,color:"white",class:"q-ml-xs"},null,8,["name"])]),_:2},1032,["label","style"]))),128))]),_:2},1032,["class"]),o(S,{class:g({"task-archived":s.status==="archived"})},{default:l(()=>[o(B,{class:"row"},{default:l(()=>[y("div",{class:g({"q-mr-sm":!0,"text-white":t.theme==="dark","text-dark":t.theme!=="dark"})},v(e.$t("pages.tasks.titles.priority"))+": ",3),y("div",{class:g({"text-grey-7":s.priority.weight<3&&s.status!=="ended","text-red-5":s.priority.weight===4&&s.status!=="ended","text-orange-5":s.priority.weight===3&&s.status!=="ended","text-green-5":s.status==="ended"})},v(s.priority.weight>3&&s.status!=="ended"?e.$t("pages.tasks.messages.urgent_task"):" "+t.priorities[s.priority.name].name)+" "+v(s.status==="ended"?` (${e.$t("pages.tasks.titles.finalized")})`:""),3)]),_:2},1024)]),_:2},1032,["class"]),o(ae,{dark:t.theme==="dark"},null,8,["dark"]),o(S,{class:g({"task-archived":s.status==="archived"})},{default:l(()=>[o(B,{style:{"user-select":"text","overflow-wrap":"break-word","word-wrap":"break-word","white-space":"normal"},class:g({"text-dark":t.theme!=="dark"})},{default:l(()=>[x(v(s.description.length>230?s.description.substring(0,230)+"...":s.description),1)]),_:2},1032,["class"])]),_:2},1032,["class"]),o(S,{class:g({"absolute-bottom-right":!0,"text-grey-7":s.status!=="ended","text-green-5":s.status==="ended","task-archived":s.status==="archived"}),style:{"margin-bottom":"-12px"}},{default:l(()=>[o(B,null,{default:l(()=>[x(v(e.$t("pages.tasks.titles.scheduled_for")),1)]),_:1}),o(B,{class:"flex row flex-center"},{default:l(()=>[o(q,{name:"calendar_today",class:"q-mr-sm q-mb-xs"}),x(v(s.isoDate),1)]),_:2},1024)]),_:2},1032,["class"]),o(S,{class:g({"absolute-bottom-left":!0,"text-grey-7":t.theme==="dark","text-dark":t.theme!=="dark","task-archived":s.status==="archived"}),style:{"margin-bottom":"-12px"}},{default:l(()=>[o(B,null,{default:l(()=>[x(v(e.$t("pages.tasks.titles.created_at")),1)]),_:1}),o(B,{class:"flex row flex-center"},{default:l(()=>[o(q,{name:"calendar_today",class:"q-mr-sm q-mb-xs"}),x(v(s.isoCreatedAt),1)]),_:2},1024)]),_:2},1032,["class"])]),_:2},1032,["dark","class"])]))),128))],2),y("div",Re,[t.totalTasks>t.filters.limit&&t.rows.length>0?(m(),b(qe,{key:0,modelValue:t.filters.page,"onUpdate:modelValue":a[3]||(a[3]=s=>t.filters.page=s),max:Math.ceil(t.totalTasks/t.filters.limit),color:"grey-8",dark:t.theme==="dark",class:g({"q-mt-md":!0,"text-dark":t.theme==="dark","text-white":t.theme!=="dark"}),onClick:n.filterTasks},null,8,["modelValue","max","dark","class","onClick"])):P("",!0),o(oe,{modelValue:t.filters.limit,"onUpdate:modelValue":a[4]||(a[4]=s=>t.filters.limit=s),options:t.rowsPerPageOptions,dark:t.theme==="dark",style:{"min-width":"100px"},dense:"",color:t.theme==="dark"?"white":"dark",class:"q-ml-xl q-mt-md","label-color":"grey-7"},null,8,["modelValue","options","dark","color"])])])}var Je=te(Fe,[["render",Ge]]);const Ke={category_name:/^[a-zA-Z0-9 ]{1,50}$/,category_color:/^[0-9A-Fa-f]{6}$/,category_icon:/^[a-zA-Z0-9_]{1,20}$/},We={name:"CategoriesComponent",props:{show:Boolean,_theme:String},emits:["update:show"],data(e){const a=c(e._theme),d=c(!1),h=X(),t=c([]),n=c(e.show),s=c(!1),i=c(""),p=c({name:"",color:"",icon:""}),C=c({category_name:!0,category_color:!0,category_icon:!0}),w=[{label:this.$t("pages.tasks.inputs.labels.category_name"),prop:"name",type:"text",rule:"category_name","error-message":this.$t("pages.tasks.messages.invalid_category_name"),limit:50},{label:this.$t("pages.tasks.inputs.labels.category_color"),prop:"color",type:"text",rule:"category_color","error-message":this.$t("pages.tasks.messages.invalid_category_color"),limit:6},{label:this.$t("pages.tasks.inputs.labels.category_icon"),prop:"icon",type:"text",rule:"category_icon","error-message":this.$t("pages.tasks.messages.invalid_category_icon"),limit:20}];ee(()=>{L().then(({data:f,status:r})=>{r===200&&(t.value=f.categories)})}),W(()=>e.show,f=>{n.value=f}),W(()=>e._theme,f=>{a.value=f});const I=f=>{for(const r in p.value){const k=Ke["category_"+r];if(k&&!k.test(p.value[r])){C.value["category_"+r]=!1;return}else C.value["category_"+r]=!0}i.value="",f?Be(f,p.value.name,p.value.color,p.value.icon).then(({status:r})=>{r===200?(L().then(({data:k,status:T})=>{T===200&&(t.value=k.categories,this.resetCategory(),this.$q.notify({message:this.$t("pages.tasks.messages.category_updated"),color:"green-5",position:"bottom-right",timeout:2e3}))}),s.value=!1):(console.log(r),i.value=this.$t("pages.tasks.messages.error_saving_category"))}).catch(r=>{i.value=r.message||this.$t("pages.tasks.messages.error")}):Te(p.value.name,p.value.color,p.value.icon).then(({status:r})=>{r===201?(L().then(({data:k,status:T})=>{T===200&&(t.value=k.categories,this.resetCategory(),this.$q.notify({message:this.$t("pages.tasks.messages.category_saved"),color:"green-5",position:"bottom-right",timeout:2e3}))}),s.value=!1):i.value=this.$t("pages.tasks.messages.error_saving_category")}).catch(r=>{i.value=r.message||this.$t("pages.tasks.messages.error")}),this.selectedId=null},Q=f=>{Ve(f).then(({status:r})=>{r===200?L().then(({data:k,status:T})=>{T===200&&(t.value=k.categories,this.$q.notify({message:this.$t("pages.tasks.messages.category_deleted"),color:"green-5",position:"bottom-right",timeout:2e3}))}):i.value=this.$t("pages.tasks.messages.error_deleting_category")}).catch(r=>{i.value=r.message||this.$t("pages.tasks.messages.error")})},D=f=>{h.dialog({title:this.$t("pages.tasks.titles.confirm_delete_category"),message:this.$t("pages.tasks.messages.confirm_category_delete"),dark:!0,ok:{label:this.$t("pages.tasks.buttons.yes"),color:"red-5"},cancel:{label:this.$t("pages.tasks.buttons.no"),color:"grey-8"}}).onOk(()=>{Q(f)})};return{theme:a,selectedId:c(0),categories:t,showCategories:n,inputs:w,valids:C,category:p,newCategory:s,error:i,saveCategory:I,saveType:c("new"),deleteThisCategory:Q,confirmDelete:D,editing:d}},methods:{editCategory(e){this.selectedId=e.id,this.category.name=e.name,this.category.color=e.color,this.category.icon=e.icon,this.editing=!0,this.newCategory=!0},resetCategory(){this.category.name="",this.category.color="",this.category.icon=""}}},Ze={class:"text-h6"},Xe={class:"row"},Ye={class:"text-h6"};function et(e,a,d,h,t,n){return m(),b(ye,{persistent:"",modelValue:t.showCategories,"onUpdate:modelValue":a[4]||(a[4]=s=>t.showCategories=s),dark:t.theme==="dark"},{default:l(()=>[t.newCategory?(m(),b(Y,{key:1,dark:t.theme==="dark",style:{"min-width":"80%",position:"relative",height:"100%","max-height":"80vh"},class:"q-mt-xl"},{default:l(()=>[o(_,{flat:"",rounded:"",dense:"",icon:"close",class:"absolute-top-right q-mr-xs q-mt-xs",color:t.theme==="dark"?"white":"dark",onClick:a[2]||(a[2]=()=>{n.resetCategory(),t.newCategory=!1}),style:{"z-index":"99"}},null,8,["color"]),o(S,{class:"flex"},{default:l(()=>[y("div",Ye,v(t.editing?e.$t("pages.tasks.titles.edit_category"):e.$t("pages.tasks.titles.new_category")),1)]),_:1}),o(S,null,{default:l(()=>[t.error?(m(),b(Ue,{key:0,"inline-actions":"",class:"q-mb-md text-white bg-red-5",icon:"info",dense:"",rounded:""},{default:l(()=>[x(v(t.error),1)]),_:1})):P("",!0),(m(!0),$(E,null,j(t.inputs,s=>(m(),b(ce,{key:s.prop,modelValue:t.category[s.prop],"onUpdate:modelValue":i=>t.category[s.prop]=i,label:s.label,dense:"",dark:t.theme==="dark",maxlength:s.limit,color:t.theme==="dark"?"white":"dark",clearable:"",class:"q-mb-md","error-message":s["error-message"],error:!t.valids[s.rule]},null,8,["modelValue","onUpdate:modelValue","label","dark","maxlength","color","error-message","error"]))),128)),o(_,{label:t.editing?e.$t("pages.tasks.buttons.update"):e.$t("pages.tasks.buttons.save"),color:"grey-8",onClick:a[3]||(a[3]=s=>t.saveCategory(t.selectedId)),class:"q-mt-md"},null,8,["label"])]),_:1})]),_:1},8,["dark"])):(m(),b(Y,{key:0,dark:t.theme==="dark",style:{"min-width":"80%",position:"relative",height:"100%","max-height":"80vh"},class:"q-mt-xl"},{default:l(()=>[o(_,{flat:"",rounded:"",dense:"",icon:"close",class:"absolute-top-right q-mr-xs q-mt-xs",color:t.theme==="dark"?"white":"dark",onClick:a[0]||(a[0]=()=>{e.$emit("update:show",!1),t.showCategories=!1}),style:{"z-index":"99"}},null,8,["color"]),o(S,{class:"flex"},{default:l(()=>[y("div",Ze,[x(v(e.$t("pages.tasks.titles.categories"))+" ",1),o(_,{class:"q-ml-md q-pl-xs q-pr-xs q-pt-none q-pb-none",size:"sm",color:"grey-8",icon:"add",onClick:a[1]||(a[1]=()=>{t.newCategory=!0,t.editing=!1})})])]),_:1}),o(S,{style:{overflow:"auto","max-height":"60vh"}},{default:l(()=>[o(me,null,{default:l(()=>[(m(!0),$(E,null,j(t.categories,s=>(m(),b(O,{key:s.name,class:g({"q-mb-sm":!0,"category-item-hover":!0,"t-light":t.theme==="light"})},{default:l(()=>[o(N,null,{default:l(()=>[y("div",Xe,[o(q,{name:s.icon.toLowerCase()||"folder",style:Z("color: #"+s.color),size:"sm"},null,8,["name","style"]),o(B,{class:"q-ml-md text-h6",style:Z("color: #"+s.color)},{default:l(()=>[x(v(s.name),1)]),_:2},1032,["style"])])]),_:2},1024),o(N,{side:""},{default:l(()=>[y("div",null,[o(_,{flat:"",dense:"",icon:"edit",onClick:i=>n.editCategory(s)},null,8,["onClick"]),o(_,{flat:"",dense:"",color:"red-5",icon:"delete",onClick:i=>t.confirmDelete(s.id)},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1},8,["dark"]))]),_:1},8,["modelValue","dark"])}var tt=te(We,[["render",et]]);const st=be({name:"TasksPage",mounted(){X().loading.hide()},setup(){const e=c(F.get("theme")),a=c(F.get("configurations")),d=new ge(()=>{e.value=F.get("theme"),a.value=F.get("configurations")});d.start(),ue(()=>{d.stop()});const h=X(),t=c(!1),n=c(!1);return{configurations:a,theme:e,showForm:t,showTask:n,showMessage:(s,i)=>{const p={success:{color:"positive",icon:"verified"},error:{color:"negative",icon:"error"},warning:{color:"warning",icon:"warning"},info:{color:"info",icon:"notification_important"}},{color:C,icon:w}=p[s],[I,Q,D,f,r]=["white","bottom-right",!0,null,1500];h.notify({color:C,icon:w,textColor:I,position:Q,message:i,multiline:D,actions:f,timeout:r})},task:c({}),showNewCategoryForm:c(!1)}},components:{QuasarTableComponent:Je,NewTaskComponent:Se,TaskComponent:Qe,CategoriesComponent:tt},methods:{showNewTaskForm(){this.showForm=!0},saveTask(){this.showForm=!1,this.showMessage("success","Task saved successfully")},archivedTaskHandler(e){let a=e.length>1?"s":"";e.length>0?this.showMessage("info",`Task${a} archived successfully`):this.showMessage("warning","No tasks selected")},deletedTaskHandler(e){let a=e.length>1?"s":"";e.length>0?this.showMessage("info",`Task${a} deleted successfully`):this.showMessage("warning","No tasks selected")},handleShowTask(e){this.task=e,this.showTask=!0},showFixedTasks(){U.emit("show-fixed-tasks")}}}),at={id:"t-tasks-content"},ot=y("i",{class:"fa fa-thumbtack",style:{transform:"rotate(45deg)"}},null,-1);function lt(e,a,d,h,t,n){const s=J("NewTaskComponent"),i=J("CategoriesComponent"),p=J("QuasarTableComponent"),C=J("TaskComponent");return m(),b(we,{class:"flex",style:{height:"100%",overflow:"auto"}},{default:l(()=>[y("div",at,[o(s,{show:e.showForm,"onUpdate:show":a[0]||(a[0]=w=>e.showForm=w),"onUpdate:save":e.saveTask,_theme:e.theme,_configurations:e.configurations},null,8,["show","onUpdate:save","_theme","_configurations"]),o(i,{show:e.showNewCategoryForm,"onUpdate:show":a[1]||(a[1]=w=>e.showNewCategoryForm=w),_theme:e.theme},null,8,["show","_theme"]),o(p,{"onUpdate:newtask":e.showNewTaskForm,"onUpdate:archivetask":e.archivedTaskHandler,"onUpdate:deletetask":e.deletedTaskHandler,"onUpdate:showtask":e.handleShowTask,"onUpdate:newcategory":a[2]||(a[2]=w=>e.showNewCategoryForm=w)},null,8,["onUpdate:newtask","onUpdate:archivetask","onUpdate:deletetask","onUpdate:showtask"]),o(C,{_theme:e.theme,task:e.task,"onUpdate:show":a[3]||(a[3]=w=>e.showTask=!1),"onUpdate:edittask":a[4]||(a[4]=()=>{e.showForm=!0,e.showTask=!1}),show:e.showTask},null,8,["_theme","task","show"]),o(_,{color:"grey-7",dark:"",size:"md",class:"fixed-bottom-right q-mr-md q-mb-md",onClick:e.showFixedTasks},{default:l(()=>[ot]),_:1},8,["onClick"])])]),_:1})}var qt=te(st,[["render",lt]]);export{qt as default};
