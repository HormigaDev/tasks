import{Q as W}from"./QPage.0b5360e2.js";import{_ as N,r as f,q as $,w as q,I as u,J as T,M as m,j as r,aG as X,Q as h,K as n,U as Q,aF as x,L as A,O as w,S as y,F as j,V as E,P as p,aI as v,N as P,aK as D,l as I,i as Y,n as F,be as L,c as S,t as Z,h as c,m as B,v as ee,y as te,ap as ie,g as se,aL as O,aN as M,d as ae,H as U}from"./index.e4e1665e.js";import{Q as z,b as le}from"./QSelect.7eeb172c.js";import{Q as re}from"./QPagination.87d30b4c.js";import{f as K}from"./formatDate.4ebb14cd.js";import{A as C}from"./API.3709199d.js";import{u as R,E as b}from"./EventBus.75c4d29c.js";import{s as g}from"./virtualStorage.e693ceb7.js";import{L as G}from"./utils.a8996564.js";import{Q as H}from"./QForm.ec3ed980.js";import"./QItem.bda02f41.js";import"./format.16e7e6eb.js";import"./configs.2921b602.js";async function oe(e,i,l,o,t,a){const s=new URLSearchParams;s.append("search",e),s.append("page",i),s.append("limit",l),s.append("archiveds",o?"true":!1),s.append("order_by",t),s.append("asc_desc",a);const{data:d,status:k}=await C.get(`/get-affairs?${s.toString()}`);return{data:d,status:k}}async function ne(e){const{data:i,status:l}=await C.get(`/get-affair-timelines?affair_id=${e}`);return{data:i,status:l}}async function fe(e,i,l){const{data:o,status:t}=await C.post("/new-affair",{title:e,person_name:i,first_timeline_description:l});return{data:o,status:t}}async function de(e,i,l){const{data:o,status:t}=await C.post("/new-affair-timeline",{affair_id:e,title:i,description:l});return console.log(e),console.log(o.message),{data:o,status:t}}async function J({affair_id:e,title:i,person_name:l,status:o}){const{data:t,status:a}=await C.put("/edit-affair",{affair_id:e,title:i,person_name:l,status:o});return console.log(t.message),{data:t,status:a}}async function me(e){const{data:i,status:l}=await C.delete(`/delete-affair?affair_id=${e}`);return{data:i,status:l}}async function ue({affair_id:e,timeline_id:i,title:l,description:o}){const{data:t,status:a}=await C.put("/edit-affair-timeline",{affair_id:e,timeline_id:i,title:l,description:o});return{data:t,status:a}}async function ce(e,i){const{data:l,status:o}=await C.delete(`/delete-affair-timeline?affair_id=${e}&timeline_id=${i}`);return{data:l,status:o}}const he={name:"AffairsTableComponent",props:{_theme:String},data(e){const i=f(e._theme),l=R(),o=f([]),t=f(0),a=f({page:1,limit:10,search:"",showArchiveds:!1,order_by:{label:this.$t("pages.affairs.inputs.options.orders_by.created_at"),value:"created_at"},asc_desc:{label:this.$t("pages.affairs.inputs.options.orders.asc"),value:"asc"}}),s=()=>{oe(a.value.search,a.value.page,a.value.limit,a.value.showArchiveds,a.value.order_by.value,a.value.asc_desc.value).then(({data:k,status:_})=>{_===200&&(o.value=k.affairs,t.value=k.total)})},d=new G(()=>{s()});return d.start(),$(()=>{d.stop()}),b.on("affair-created",()=>{s()}),b.on("affair-updated",()=>{s()}),q(()=>i.value,()=>{g.set("theme",i.value)}),{theme:i,actualizeAffairs:s,totalAffairs:t,filters:a,affairs:o,rowsPerPageOptions:[10,20,30,50,100],orderByOptions:[{label:this.$t("pages.affairs.inputs.options.orders_by.created_at"),value:"created_at"},{label:this.$t("pages.affairs.inputs.options.orders_by.last_update"),value:"last_update"},{label:this.$t("pages.affairs.inputs.options.orders_by.person_name"),value:"person_name"},{label:this.$t("pages.affairs.inputs.options.orders_by.title"),value:"title"}],ascDescOptions:[{label:this.$t("pages.affairs.inputs.options.orders.asc"),value:"asc"},{label:this.$t("pages.affairs.inputs.options.orders.desc"),value:"desc"}],formatDate:K,confirmDelete:(k,_)=>{l.dialog({title:this.$t("pages.affairs.titles.confirm_deletion"),message:this.$t("pages.affairs.messages.confirm_delete"),cancel:{label:this.$t("pages.affairs.buttons.cancel"),color:"grey-8"},persistent:!0,color:"red-5",dark:i.value==="dark",ok:{label:this.$t("pages.affairs.buttons.delete"),color:"red-5"}}).onOk(()=>{k(_)}).onCancel(()=>{})}}},methods:{newAffair(){this.$emit("update:newaffair",!0)},archiveAffair(e,i){J({affair_id:e,status:i==="archived"?"created":"archived"}).then(({status:l})=>{l===200&&(console.log("status",l),this.$q.notify({message:this.$t(`pages.affairs.messages.affair_${i==="archived"?"unarchived":"archived"}`),color:this.theme==="dark"?"green-5":"green",position:"bottom-right",timeout:2e3}),this.actualizeAffairs())}).catch(l=>{console.log(l)})},showArchiveds(){this.filters.page=1,this.actualizeAffairs()},confirmDeletion(e){this.confirmDelete(this.deleteAffair,e)},deleteAffair(e){me(e).then(({status:i})=>{i===200&&(this.actualizeAffairs(),this.$q.notify({message:this.$t("pages.affairs.messages.affair_deleted"),color:this.theme==="dark"?"red-5":"red",position:"bottom-right",timeout:2e3}))}).catch(i=>{console.log(i),this.$q.notify({message:this.$t("pages.affairs.messages.error_deleting_affair"),color:this.theme==="dark"?"red-5":"red",position:"bottom-right",timeout:2e3})})},filterAffairs(e=!1){e||(this.filters.page=1),this.actualizeAffairs()},showAffair(e){e.timelines=[],g.set("current_affair",e.id),this.$emit("update:selectaffair",e)}}},pe={class:"q-pa-md"},ge={class:"row flex flex-center"},we={class:"flex row t-table-header q-mt-sm"},ke={class:"flex row q-mt-sm"},ve={key:0,class:"absolute-top-left flex flex-center",style:{width:"100%",height:"100%"}},ye={class:"text-h6"},be={class:"text-left flex justify-end",style:{"font-size":"13px"}},_e={class:"text-left flex justify-end",style:{"font-size":"13px"}},Ae={class:"flex flex-center"};function qe(e,i,l,o,t,a){return u(),T("div",pe,[m("div",ge,[m("div",we,[r(X,{dense:"",dark:t.theme==="dark",color:"grey-8",class:"q-ml-md",label:e.$t("pages.affairs.inputs.labels.show_archiveds"),modelValue:t.filters.showArchiveds,"onUpdate:modelValue":[i[0]||(i[0]=s=>t.filters.showArchiveds=s),a.showArchiveds]},null,8,["dark","label","modelValue","onUpdate:modelValue"]),r(h,{dense:"",dark:t.theme==="dark",color:"grey-8",icon:"add",class:"q-ml-md",onClick:a.newAffair},null,8,["dark","onClick"])]),m("div",ke,[r(z,{dense:"",dark:t.theme==="dark",outlined:"",color:t.theme==="dark"?"white":"dark",options:t.orderByOptions,modelValue:t.filters.order_by,"onUpdate:modelValue":[i[1]||(i[1]=s=>t.filters.order_by=s),a.filterAffairs],label:e.$t("pages.affairs.inputs.labels.order_by"),class:"q-ml-md",style:{"min-width":"140px"}},null,8,["dark","color","options","modelValue","label","onUpdate:modelValue"]),r(z,{dense:"",dark:t.theme==="dark",outlined:"",color:t.theme==="dark"?"white":"dark",modelValue:t.filters.asc_desc,"onUpdate:modelValue":[i[2]||(i[2]=s=>t.filters.asc_desc=s),a.filterAffairs],options:t.ascDescOptions,label:e.$t("pages.affairs.inputs.labels.order"),class:"q-ml-md",style:{"min-width":"100px"}},null,8,["dark","color","modelValue","options","label","onUpdate:modelValue"]),r(x,{dense:"",dark:t.theme==="dark",outlined:"",color:t.theme==="dark"?"white":"dark",debounce:"200",modelValue:t.filters.search,"onUpdate:modelValue":[i[3]||(i[3]=s=>t.filters.search=s),a.filterAffairs],placeholder:e.$t("pages.affairs.inputs.labels.search_affair"),class:"q-ml-md"},{append:n(()=>[r(Q,{name:"search"})]),_:1},8,["dark","color","modelValue","placeholder","onUpdate:modelValue"])])]),m("div",{class:A({"t-light":t.theme!=="dark","t-affairs-content":!0,row:!0}),style:{position:"relative"}},[t.affairs.length===0?(u(),T("div",ve,[m("div",{class:A({"text-h4":!0,"text-grey-7":t.theme==="dark","text-grey-6":t.theme!=="dark"})},w(e.$t("pages.affairs.titles.nothing_to_show")),3)])):y("",!0),(u(!0),T(j,null,E(t.affairs,s=>(u(),T("div",{key:s.id,class:A({"col-12":!0,column:!0,"q-mb-md":!0,"t-affair-card":!0,"t-light":t.theme!=="dark"})},[r(D,{vertical:"",dark:t.theme==="dark",class:"row q-pa-md",style:{height:"100%"},flat:""},{default:n(()=>[r(v,{class:A({"col-4":!0,"bg-grey-9":t.theme==="dark","bg-grey-4":t.theme!=="dark",flex:!0,"flex-center":!0,"cursor-pointer":!0}),onClick:d=>a.showAffair(s)},{default:n(()=>[m("div",ye,w(s.title),1)]),_:2},1032,["class","onClick"]),r(v,{class:"col-2 flex flex-center"},{default:n(()=>[m("div",{class:A({"text-center":!0,"text-bold":t.theme!=="dark"})},w(s.personName),3)]),_:2},1024),r(v,{class:A({"col-2":!0,"text-grey-7":t.theme==="dark","text-grey-9":t.theme!=="dark","text-right":!0,"justify-center":!0,flex:!0,column:!0})},{default:n(()=>[m("div",null,w(e.$t("pages.affairs.titles.created_at")),1),m("div",be,[r(Q,{name:"calendar_today",class:"q-mr-xs",size:"xs"}),P(w(t.formatDate(s.createdAt)),1)])]),_:2},1032,["class"]),r(v,{class:"col-2 text-brown text-right justify-center flex column"},{default:n(()=>[m("div",null,w(e.$t("pages.affairs.titles.last_update")),1),m("div",_e,[r(Q,{name:"calendar_today",class:"q-mr-xs",size:"xs"}),P(w(t.formatDate(s.lastUpdate)),1)])]),_:2},1024),r(v,{class:"col-2"},{default:n(()=>[r(h,{dense:"",dark:t.theme==="dark",color:"grey-8",icon:s.status==="archived"?"unarchive":"archive",class:"q-mr-xs",onClick:d=>a.archiveAffair(s.id,s.status)},null,8,["dark","icon","onClick"]),r(h,{dense:"",dark:t.theme==="dark",color:"red-5",icon:"delete",class:"q-ml-sm q-mr-xs",onClick:d=>a.confirmDeletion(s.id)},null,8,["dark","onClick"]),s.status==="archived"?(u(),p(le,{key:0,label:e.$t("pages.affairs.inputs.labels.archived"),color:t.theme==="dark"?"grey-8":"grey-5","text-:color":"theme === 'dark'?'white':'dark'",size:"sm"},null,8,["label","color"])):y("",!0)]),_:2},1024)]),_:2},1032,["dark"])],2))),128))],2),m("div",Ae,[t.totalAffairs>t.filters.limit&&t.affairs.length>0?(u(),p(re,{key:0,modelValue:t.filters.page,"onUpdate:modelValue":i[4]||(i[4]=s=>t.filters.page=s),max:Math.ceil(t.totalAffairs/t.filters.limit),color:"grey-8",dark:t.theme==="dark",class:"q-mt-md text-dark",onClick:i[5]||(i[5]=s=>a.filterAffairs(!0))},null,8,["modelValue","max","dark"])):y("",!0),r(z,{modelValue:t.filters.limit,"onUpdate:modelValue":i[6]||(i[6]=s=>t.filters.limit=s),options:t.rowsPerPageOptions,dark:t.theme==="dark",style:{"min-width":"100px"},dense:"",color:t.theme==="dark"?"white":"dark",class:"q-ml-xl q-mt-md","label-color":"grey-7"},null,8,["modelValue","options","dark","color"])])])}var Ce=N(he,[["render",qe]]),Ve=I({name:"QTimelineEntry",props:{heading:Boolean,tag:{type:String,default:"h3"},side:{type:String,default:"right",validator:e=>["left","right"].includes(e)},icon:String,avatar:String,color:String,title:String,subtitle:String,body:String},setup(e,{slots:i}){const l=Y(L,F);if(l===F)return console.error("QTimelineEntry needs to be child of QTimeline"),F;const o=S(()=>`q-timeline__entry q-timeline__entry--${e.side}`+(e.icon!==void 0||e.avatar!==void 0?" q-timeline__entry--icon":"")),t=S(()=>`q-timeline__dot text-${e.color||l.color}`),a=S(()=>l.layout==="comfortable"&&l.side==="left");return()=>{const s=Z(i.default,[]);if(e.body!==void 0&&s.unshift(e.body),e.heading===!0){const _=[c("div"),c("div"),c(e.tag,{class:"q-timeline__heading-title"},s)];return c("div",{class:"q-timeline__heading"},a.value===!0?_.reverse():_)}let d;e.icon!==void 0?d=[c(Q,{class:"row items-center justify-center",name:e.icon})]:e.avatar!==void 0&&(d=[c("img",{class:"q-timeline__dot-img",src:e.avatar})]);const k=[c("div",{class:"q-timeline__subtitle"},[c("span",{},B(i.subtitle,[e.subtitle]))]),c("div",{class:t.value},d),c("div",{class:"q-timeline__content"},[c("h6",{class:"q-timeline__title"},B(i.title,[e.title]))].concat(s))];return c("li",{class:o.value},a.value===!0?k.reverse():k)}}}),Te=I({name:"QTimeline",props:{...ee,color:{type:String,default:"primary"},side:{type:String,default:"right",validator:e=>["left","right"].includes(e)},layout:{type:String,default:"dense",validator:e=>["dense","comfortable","loose"].includes(e)}},setup(e,{slots:i}){const l=se(),o=te(e,l.proxy.$q);ie(L,e);const t=S(()=>`q-timeline q-timeline--${e.layout} q-timeline--${e.layout}--${e.side}`+(o.value===!0?" q-timeline--dark":""));return()=>c("ul",{class:t.value},B(i.default))}});const xe={name:"AffairComponent",props:{showProp:Boolean,affairProp:Object,_theme:String},emits:["update:show","update:newtimeline","update:editaffair"],data(e){const i=f(e._theme),l=f(e.affairProp),o=R(),t=()=>{ne(l.value.id).then(({data:a,status:s})=>{s===200&&(l.value.timelines=a.timelines)})};return t(),q(()=>e.showProp,a=>{a&&(show.value=a)}),q(()=>e.affairProp,a=>{a&&(l.value=a)}),q(()=>e._theme,a=>{i.value=a}),b.on("timeline-created",()=>{t()}),b.on("timeline-updated",()=>{t()}),{theme:i,actualizeTimelines:t,show:f(e.showProp),affair:l,editing:f(!1),formatDate:K,confirmDelete:(a,s)=>{o.dialog({title:this.$t("pages.affairs.titles.confirm_deletion"),message:this.$t("pages.affairs.messages.confirm_delete_timeline"),cancel:{label:this.$t("pages.affairs.buttons.cancel"),color:"grey-8"},persistent:!0,color:"red-5",dark:i.value==="dark",ok:{label:this.$t("pages.affairs.buttons.delete"),color:"red-5"}}).onOk(()=>{a(s)}).onCancel(()=>{})}}},methods:{randomColor(){const e=["primary","secondary","accent","positive","info","warning","purple","pink","green","blue","yellow","cyan","teal","orange","deep-orange","deep-purple","light-blue","light-green","lime","amber","brown","grey","blue-grey"];return e[Math.floor(Math.random()*e.length)]},newTimeline(){b.emit("new-affair-timeline",this.affair.id),this.$emit("update:newtimeline",!0)},editAffair(e){g.set("editingAffair",{title:this.affair.title,personName:this.affair.personName,id:e}),this.$emit("update:editaffair",!0),this.$emit("update:show",!1)},editTimeline(e){g.set("editingTimeline",e),this.$emit("update:newtimeline",!0)},confirmDeletionTimeline(e){this.confirmDelete(this.deleteTimeline,e)},deleteTimeline(e){ce(g.get("current_affair"),e).then(({status:i})=>{i===200&&(this.$q.notify({message:this.$t("pages.affairs.messages.timeline_deleted"),color:"green-5",position:"bottom-right",timeout:2e3}),this.actualizeTimelines())})}}},Ne={class:"text-h6"},Ue={style:{"user-select":"text","white-space":"pre-line"}};function Qe(e,i,l,o,t,a){return u(),p(O,{persistent:"",modelValue:t.show,"onUpdate:modelValue":i[3]||(i[3]=s=>t.show=s),dark:t.theme==="dark"},{default:n(()=>[r(D,{dark:t.theme==="dark",style:{"min-width":"80%",position:"relative",height:"100%","max-height":"80vh"},class:"q-mt-xl"},{default:n(()=>[r(h,{flat:"",rounded:"",dense:"",icon:"close",class:"absolute-top-right q-mr-xs q-mt-xs",color:t.theme==="dark"?"white":"dark",style:{"z-index":"99"},onClick:i[0]||(i[0]=()=>e.$emit("update:show",!1))},null,8,["color"]),r(v,{class:"flex",style:{position:"sticky"}},{default:n(()=>[m("div",Ne,[P(w(t.affair.title)+" ",1),r(h,{dense:"",color:"grey-7",icon:"add",size:"sm",class:"q-ml-lg",onClick:a.newTimeline},null,8,["onClick"]),r(h,{dense:"",color:"grey-7",icon:"edit",size:"sm",class:"q-ml-md",onClick:i[1]||(i[1]=s=>t.editing=!t.editing)}),t.editing?(u(),p(h,{key:0,dense:"",color:"grey-7",icon:"edit",size:"sm",class:"q-ml-md q-pr-sm q-pl-xs",label:e.$t("pages.affairs.buttons.edit_affair"),onClick:i[2]||(i[2]=s=>a.editAffair(t.affair.id))},null,8,["label"])):y("",!0)])]),_:1}),r(v,{style:{"max-height":"60vh",height:"100%"}},{default:n(()=>[m("div",{class:A({"q-px-lg":!0,"q-py-md":!0,"t-light":t.theme!=="dark"}),style:{"max-height":"60vh",height:"100%",overflow:"auto"}},[r(Te,{color:"secondary"},{default:n(()=>[(u(!0),T(j,null,E(t.affair.timelines,s=>(u(),p(Ve,{key:s.id,title:s.title,subtitle:t.formatDate(s.createdAt),color:"grey-7",icon:t.editing?"edit":"schedule"},{subtitle:n(()=>[m("div",null,[t.editing?(u(),p(h,{key:0,size:"xs",icon:"edit",color:"grey-7",class:"q-pa-xs q-mr-sm",onClick:d=>a.editTimeline(s)},null,8,["onClick"])):y("",!0),t.editing?(u(),p(h,{key:1,size:"xs",icon:"delete",color:"red",class:"q-pa-xs q-mr-sm",onClick:d=>a.confirmDeletionTimeline(s.id)},null,8,["onClick"])):y("",!0),P(" "+w(t.formatDate(s.createdAt)),1)])]),default:n(()=>[m("div",Ue,w(s.description),1)]),_:2},1032,["title","subtitle","icon"]))),128))]),_:1})],2)]),_:1})]),_:1},8,["dark"])]),_:1},8,["modelValue","dark"])}var Se=N(xe,[["render",Qe]]);const Pe={name:"NewAffairTimelineComponent",props:{show:Boolean,_theme:String},emits:["update:show"],data(e){const i=f(e._theme),l=f(e.show),o=f(!1),t=f({title:"",description:"",id:""}),a=g.get("editingTimeline");return a&&(o.value=!0,t.value.title=a.title,t.value.description=a.description,t.value.id=a.id),q(()=>e.show,s=>{l.value=s}),q(()=>e._theme,s=>{i.value=s}),{theme:i,showForm:l,newAffair:t,editing:o}},methods:{resetForm(){this.newAffair={title:"",description:""},g.remove("editingTimeline")},saveTimeline(){if(this.editing){ue({affair_id:g.get("current_affair"),title:this.newAffair.title,description:this.newAffair.description,timeline_id:this.newAffair.id}).then(({status:e})=>{e===200&&(this.$q.notify({color:"green-5",position:"bottom-right",message:"Timeline updated"}),this.resetForm(),b.emit("timeline-updated"),this.$emit("update:show",!1))}).catch(e=>{console.log(e),this.$q.notify({color:"red-5",position:"bottom-right",message:"Error updating timeline"})});return}de(g.get("current_affair"),this.newAffair.title,this.newAffair.description).then(({status:e})=>{e===201&&(this.resetForm(),b.emit("timeline-created"),this.$emit("update:show",!1))}).catch(e=>{console.log(e),this.$q.notify({color:"red-5",position:"bottom-right",message:"Error creating timeline"})})},editTimeline(){}}},De={class:"text-h6"};function Fe(e,i,l,o,t,a){return u(),p(O,{persistent:"",modelValue:t.showForm,"onUpdate:modelValue":i[3]||(i[3]=s=>t.showForm=s),dark:t.theme==="dark"},{default:n(()=>[r(D,{style:{"min-width":"560px"},dark:t.theme==="dark"},{default:n(()=>[r(v,null,{default:n(()=>[m("div",De,w(t.editing?e.$t("pages.affairs.titles.edit_affair_timeline"):e.$t("pages.affairs.titles.new_affair_timeline")),1)]),_:1}),r(v,{class:"q-pt-none"},{default:n(()=>[r(H,null,{default:n(()=>[r(x,{dark:t.theme==="dark",dense:"",outlined:"",modelValue:t.newAffair.title,"onUpdate:modelValue":i[0]||(i[0]=s=>t.newAffair.title=s),label:e.$t("pages.affairs.inputs.labels.affair_timeline_title"),type:"text",class:"q-mt-md",color:t.theme==="dark"?"white":"dark","label-color":t.theme==="dark"?"grey-7":"grey-9"},null,8,["dark","modelValue","label","color","label-color"]),r(x,{dark:t.theme==="dark",dense:"",outlined:"",modelValue:t.newAffair.description,"onUpdate:modelValue":i[1]||(i[1]=s=>t.newAffair.description=s),label:e.$t("pages.affairs.inputs.labels.affair_timeline_description"),type:"textarea",class:"q-mt-md",color:t.theme==="dark"?"white":"dark","label-color":t.theme==="dark"?"grey-7":"grey-9"},null,8,["dark","modelValue","label","color","label-color"])]),_:1})]),_:1}),r(M,{align:"right",class:"text-primary"},{default:n(()=>[r(h,{flat:"",color:t.theme==="dark"?"grey-5":"grey-9",label:e.$t("pages.affairs.buttons.cancel"),onClick:i[2]||(i[2]=()=>{a.resetForm(),e.$emit("update:show",!1)})},null,8,["color","label"]),r(h,{flat:"",label:t.editing?e.$t("pages.affairs.buttons.update"):e.$t("pages.affairs.buttons.save"),onClick:a.saveTimeline},null,8,["label","onClick"])]),_:1})]),_:1},8,["dark"])]),_:1},8,["modelValue","dark"])}var ze=N(Pe,[["render",Fe]]);const Be={name:"NewAffairComponent",props:{show:Boolean,_theme:String},emits:["update:show"],data(e){const i=f(e._theme),l=f(e.show),o=f({id:null,title:"",personName:"",description:""}),t=f(!1),a=g.get("editingAffair");return a&&(t.value=!0,o.value.title=a.title,o.value.personName=a.personName,o.value.description=null,o.value.id=a.id),console.log(t.value),q(()=>e.show,d=>{l.value=d}),q(()=>e._theme,d=>{i.value=d}),{theme:i,showForm:l,newAffair:o,resetForm:()=>{o.value={id:null,title:"",personName:"",description:""},t.value=!1,g.remove("editingAffair")},editing:t}},methods:{createAffair(){if(this.editing){J({affair_id:this.newAffair.id,title:this.newAffair.title,personName:this.newAffair.personName}).then(({status:e})=>{e===200&&(this.$q.notify({message:this.$t("pages.affairs.messages.affair_updated"),color:"green-5",position:"bottom-right",timeout:2e3}),b.emit("affair-updated"),this.resetForm(),this.$emit("update:show",!1))});return}fe(this.newAffair.title,this.newAffair.personName,this.newAffair.description).then(({status:e})=>{e===201&&(this.$q.notify({message:this.$t("pages.affairs.messages.affair_created"),color:"green-5",position:"bottom-right",timeout:2e3}),b.emit("affair-created"),this.resetForm(),this.$emit("update:show",!1))}).catch(e=>{console.log(e),this.$q.notify({message:this.$t("pages.affairs.messages.error_creating_affair"),color:"red-5",position:"bottom-right",timeout:2e3})})},cancelAffairCreation(){this.resetForm(),this.$emit("update:show",!1)}}},Oe={class:"text-h6"};function $e(e,i,l,o,t,a){return u(),p(O,{persistent:"",modelValue:t.showForm,"onUpdate:modelValue":i[2]||(i[2]=s=>t.showForm=s),dark:t.theme==="dark"},{default:n(()=>[r(D,{style:{"min-width":"560px"},dark:t.theme==="dark"},{default:n(()=>[r(v,null,{default:n(()=>[m("div",Oe,w(t.editing?e.$t("pages.affairs.titles.edit_affair"):e.$t("pages.affairs.titles.new_affair")),1)]),_:1}),r(v,{class:"q-pt-none"},{default:n(()=>[r(H,null,{default:n(()=>[r(x,{dark:t.theme==="dark",dense:"",outlined:"",modelValue:t.newAffair.title,"onUpdate:modelValue":i[0]||(i[0]=s=>t.newAffair.title=s),label:e.$t("pages.affairs.inputs.labels.affair_title"),type:"text",class:"q-mt-md",color:t.theme==="dark"?"white":"dark","label-color":t.theme==="dark"?"grey-7":"grey-9"},null,8,["dark","modelValue","label","color","label-color"]),r(x,{dark:t.theme==="dark",dense:"",outlined:"",modelValue:t.newAffair.description,"onUpdate:modelValue":i[1]||(i[1]=s=>t.newAffair.description=s),label:e.$t("pages.affairs.inputs.labels.affair_first_timeline_description"),type:"textarea",class:A({"q-mt-md":!0,"t-input-disabled":t.newAffair.description===null}),color:t.theme==="dark"?"white":"dark","label-color":t.theme==="dark"?"grey-7":"grey-9"},null,8,["dark","modelValue","label","class","color","label-color"])]),_:1})]),_:1}),r(M,{align:"right",class:"text-primary"},{default:n(()=>[r(h,{flat:"",color:t.theme==="dark"?"grey-5":"grey-9",label:e.$t("pages.affairs.buttons.cancel"),onClick:a.cancelAffairCreation},null,8,["color","label","onClick"]),r(h,{flat:"",label:t.editing?e.$t("pages.affairs.buttons.update"):e.$t("pages.affairs.buttons.save"),onClick:a.createAffair},null,8,["label","onClick"])]),_:1})]),_:1},8,["dark"])]),_:1},8,["modelValue","dark"])}var je=N(Be,[["render",$e]]);const Ee=ae({components:{AffairsTableComponent:Ce,AffairComponent:Se,NewAffairTimelineComponent:ze,NewAffairComponent:je},data(){const e=f(g.get("theme")),i=new G(()=>{e.value=g.get("theme")});return i.start(),$(()=>{i.stop()}),{theme:e,show:f(!1),affair:f({}),showNewTimeline:f(!1),showNewAffair:f(!1)}},methods:{selectAffair(e){this.affair=e,this.show=!0},newTimeline(){this.showNewTimeline=!0}}});function Ie(e,i,l,o,t,a){const s=U("AffairComponent"),d=U("NewAffairTimelineComponent"),k=U("NewAffairComponent"),_=U("AffairsTableComponent");return u(),p(W,null,{default:n(()=>[e.show?(u(),p(s,{key:0,showProp:e.show,"onUpdate:show":i[0]||(i[0]=V=>e.show=V),affairProp:e.affair,"onUpdate:newtimeline":e.newTimeline,"onUpdate:editaffair":i[1]||(i[1]=V=>e.showNewAffair=!0),_theme:e.theme},null,8,["showProp","affairProp","onUpdate:newtimeline","_theme"])):y("",!0),e.showNewTimeline?(u(),p(d,{key:1,show:e.showNewTimeline,"onUpdate:show":i[2]||(i[2]=V=>e.showNewTimeline=V),_theme:e.theme},null,8,["show","_theme"])):y("",!0),e.showNewAffair?(u(),p(k,{key:2,show:e.showNewAffair,"onUpdate:show":i[3]||(i[3]=V=>e.showNewAffair=V),_theme:e.theme},null,8,["show","_theme"])):y("",!0),m("div",null,[r(_,{"onUpdate:selectaffair":e.selectAffair,"onUpdate:newaffair":i[4]||(i[4]=V=>e.showNewAffair=!0),_theme:e.theme},null,8,["onUpdate:selectaffair","_theme"])])]),_:1})}var it=N(Ee,[["render",Ie]]);export{it as default};
