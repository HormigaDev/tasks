import{l as re,c as P,h as A,m as ne,aD as ie,ad as ge,r as u,aE as he,aF as pe,w as G,o as X,U as T,Q as C,g as ke,aC as fe,_ as Y,q as de,I as g,J as S,M as b,j as o,F as H,V as O,K as l,aG as ue,L as v,X as se,O as y,S as F,P as w,aH as J,aI as Q,N as q,D as L,aJ as E,Y as te,aK as Z,aL as ve,d as ye,H as j}from"./index.1526ceda.js";import{Q as be}from"./QPage.49364285.js";import{E as I,u as K}from"./EventBus.cd526070.js";import{Q as ae,a as x}from"./QSelect.bc0c6282.js";import{Q as we,c as N,a as $}from"./format.e5b37dc8.js";import{a as ce,Q as _e}from"./QList.050e965c.js";import{Q as Ce}from"./QPagination.9bffbcad.js";import{C as R}from"./ClosePopup.616097b6.js";import{g as M,a as oe,d as qe,e as le,n as xe,b as Te,c as Be,N as Ve,T as Qe}from"./TaskComponent.47c0e5f9.js";import{s as z,L as me}from"./utils.1e00f14b.js";import{Q as Ue}from"./QBanner.226426b9.js";import"./date.38a4309f.js";import"./QForm.e88a91f9.js";import"./configs.3bfa595d.js";var Se=re({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(s,{slots:a}){const i=P(()=>{const k=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(e=>s[e]===!0).map(e=>`q-btn-group--${e}`).join(" ");return`q-btn-group row no-wrap${k.length!==0?" "+k:""}`+(s.spread===!0?" q-btn-group--spread":" inline")});return()=>A("div",{class:i.value},ne(a.default))}});const De=Object.keys(ie),Ae=s=>De.reduce((a,i)=>{const k=s[i];return k!==void 0&&(a[i]=k),a},{});var $e=re({name:"QBtnDropdown",props:{...ie,...ge,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(s,{slots:a,emit:i}){const{proxy:k}=ke(),e=u(s.modelValue),n=u(null),t=he(),r=P(()=>{const c={"aria-expanded":e.value===!0?"true":"false","aria-haspopup":"true","aria-controls":t.value,"aria-label":s.toggleAriaLabel||k.$q.lang.label[e.value===!0?"collapse":"expand"](s.label)};return(s.disable===!0||s.split===!1&&s.disableMainBtn===!0||s.disableDropdown===!0)&&(c["aria-disabled"]="true"),c}),f=P(()=>"q-btn-dropdown__arrow"+(e.value===!0&&s.noIconAnimation===!1?" rotate-180":"")+(s.split===!1?" q-btn-dropdown__arrow-container":"")),m=P(()=>pe(s)),h=P(()=>Ae(s));G(()=>s.modelValue,c=>{n.value!==null&&n.value[c?"show":"hide"]()}),G(()=>s.split,W);function B(c){e.value=!0,i("beforeShow",c)}function _(c){i("show",c),i("update:modelValue",!0)}function U(c){e.value=!1,i("beforeHide",c)}function p(c){i("hide",c),i("update:modelValue",!1)}function d(c){i("click",c)}function V(c){fe(c),W(),i("click",c)}function D(c){n.value!==null&&n.value.toggle(c)}function ee(c){n.value!==null&&n.value.show(c)}function W(c){n.value!==null&&n.value.hide(c)}return Object.assign(k,{show:ee,hide:W,toggle:D}),X(()=>{s.modelValue===!0&&ee()}),()=>{const c=[A(T,{class:f.value,name:s.dropdownIcon||k.$q.iconSet.arrow.dropdown})];return s.disableDropdown!==!0&&c.push(A(we,{ref:n,id:t.value,class:s.contentClass,style:s.contentStyle,cover:s.cover,fit:!0,persistent:s.persistent,noRouteDismiss:s.noRouteDismiss,autoClose:s.autoClose,anchor:s.menuAnchor,self:s.menuSelf,offset:s.menuOffset,separateClosePopup:!0,transitionShow:s.transitionShow,transitionHide:s.transitionHide,transitionDuration:s.transitionDuration,onBeforeShow:B,onShow:_,onBeforeHide:U,onHide:p},a.default)),s.split===!1?A(C,{class:"q-btn-dropdown q-btn-dropdown--simple",...h.value,...r.value,disable:s.disable===!0||s.disableMainBtn===!0,noWrap:!0,round:!1,onClick:d},{default:()=>ne(a.label,[]).concat(c),loading:a.loading}):A(Se,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:s.rounded,square:s.square,...m.value,glossy:s.glossy,stretch:s.stretch},()=>[A(C,{class:"q-btn-dropdown--current",...h.value,disable:s.disable===!0||s.disableMainBtn===!0,noWrap:!0,round:!1,onClick:V},{default:a.label,loading:a.loading}),A(C,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...r.value,...m.value,disable:s.disable===!0||s.disableDropdown===!0,rounded:s.rounded,color:s.color,textColor:s.textColor,dense:s.dense,size:s.size,padding:s.padding,ripple:s.ripple},()=>c)])}}}),ze=[{name:"description",align:"center",label:"Description",field:"description",sortable:!0},{name:"categories",label:"Categories",field:"categories",sortable:!1},{name:"priority",label:"Priority",field:"priority",sortable:!0}];const Pe={name:"QuasarTableComponent",data(){const s=u(z.get("theme")),a={urgent:{color:"#f22",name:this.$t("pages.tasks.inputs.options.priorities.urgent"),icon:"error"},high:{color:"#ff6",name:this.$t("pages.tasks.inputs.options.priorities.high"),icon:"warning"},normal:{color:"#66f",name:this.$t("pages.tasks.inputs.options.priorities.normal")},low:{color:"#6f6",name:this.$t("pages.tasks.inputs.options.priorities.low")}},i=u([]),k=u([]),e=u({priority:{label:this.$t("pages.tasks.inputs.options.priorities.all"),value:0},order_by:{label:this.$t("pages.tasks.inputs.options.orders_by.run_date"),value:"run_date"},asc_desc:{label:this.$t("pages.tasks.inputs.options.orders.asc"),value:"asc"},page:1,categories:[],limit:10,search:"",fixed:!1,showArchives:!1,showEndeds:!1}),n=u(0);X(()=>{M().then(({data:m,status:h})=>{if(h===200){const B=m.categories.map(_=>({label:_.name,value:_.id}));k.value=B}})});const t=async()=>{oe(e.value.page,e.value.limit,[],e.value.search,e.value.order_by.value,e.value.asc_desc.value,e.value.priority.value,e.value.fixed,e.value.showArchives,e.value.showEndeds).then(({data:m,status:h})=>{var B;h===200?(m.tasks=m.tasks.map(_=>{let[U,p,d]=_.runDate.split("-");return _.isoDate=`${d}/${p}/${U}`,[U,p,d]=_.createdAt.split("-"),d=d.split(" ")[0],_.isoCreatedAt=`${d}/${p}/${U}`,_}),i.value=m.tasks,n.value=(B=m.total)!=null?B:0):h===404&&(i.value=[])})},r=new me(()=>{s.value=z.get("theme"),t()});r.start();//!! dimounting component
de(()=>{r.stop()}),I.on("task-added",()=>{oe(e.value.page,e.value.limit,e.value.categories.map(m=>m.id),e.value.search,e.value.order_by.value,e.value.asc_desc.value,e.value.priority.value).then(({data:m,status:h})=>{h===200&&(i.value=m.tasks)})}),I.on("show-fixed-tasks",()=>{e.value.fixed=!e.value.fixed,t()}),I.on("filter-by-category",m=>{e.value.categories=[m],t()}),I.on("task-updated",()=>{t()});const f=K();return{theme:s,pagination:u(1),filter:u(""),selected:u([]),columns:ze,rows:i,originalRows:u(i),categories:k,priorities:a,filterBarOptions:[{label:this.$t("pages.tasks.inputs.labels.priority"),value:"priority",options:[{label:this.$t("pages.tasks.inputs.options.priorities.all"),value:0},{label:this.$t("pages.tasks.inputs.options.priorities.urgent"),value:4},{label:this.$t("pages.tasks.inputs.options.priorities.high"),value:3},{label:this.$t("pages.tasks.inputs.options.priorities.normal"),value:2},{label:this.$t("pages.tasks.inputs.options.priorities.low"),value:1}]},{label:this.$t("pages.tasks.inputs.labels.order_by"),value:"order_by",options:[{label:this.$t("pages.tasks.inputs.options.orders_by.run_date"),value:"run_date"},{label:this.$t("pages.tasks.inputs.options.orders_by.created_at"),value:"created_at"},{label:this.$t("pages.tasks.inputs.options.orders_by.title"),value:"title"},{label:this.$t("pages.tasks.inputs.options.orders_by.description"),value:"description"}]},{label:this.$t("pages.tasks.inputs.labels.order"),value:"asc_desc",options:[{label:this.$t("pages.tasks.inputs.options.orders.asc"),value:"asc"},{label:this.$t("pages.tasks.inputs.options.orders.desc"),value:"desc"}]}],filters:e,totalTasks:n,actualizeTasks:t,rowsPerPage:u(10),rowsPerPageOptions:[10,20,30,50,100],confirmDelete:(m,h)=>{f.dialog({title:this.$t("pages.tasks.titles.confirm_deletion"),message:this.$t("pages.tasks.messages.confirm_delete"),cancel:{label:this.$t("pages.tasks.buttons.cancel"),color:"grey-8"},persistent:!0,color:"red-5",dark:s.value==="dark",ok:{label:this.$t("pages.tasks.buttons.delete")}}).onOk(()=>{m(h)}).onCancel(()=>{})}}},methods:{newCategory(){this.$emit("update:newcategory",!0)},newTask(){this.$emit("update:newtask",!0)},deleteTask(s){s&&this.confirmDelete(this.confirm,s)},confirm(s){qe(s).then(({status:a})=>{a===200&&this.$q.notify({message:this.$t("pages.tasks.messages.task_deleted"),color:"green-5",position:"bottom-right",timeout:2e3})}).catch(a=>{console.log(a),this.$q.notify({message:this.$t("pages.tasks.messages.error_deleting_task"),color:"red-5",position:"bottom-right",timeout:2e3})})},archiveTask(s){s&&le(s,{status:"archived"}).then(({data:a,status:i})=>{i===200&&this.$q.notify({message:this.$t("pages.tasks.messages.task_archived"),color:"green-5",position:"bottom-right",timeout:2e3})})},showTask(s){this.$emit("update:showtask",s)},filterTasks(){this.actualizeTasks()},assingTask(s,a){le(s,{fixed:a}).then(({status:i})=>{i===200&&this.$q.notify({message:a?this.$t("pages.tasks.messages.task_assigned"):this.$t("pages.tasks.messages.task_unassigned"),color:"green-5",position:"bottom-right",timeout:2e3})}).catch(i=>{console.log(i)})}}},Fe={class:"q-pa-md"},Ie={class:"flex row"},Ne={class:"flex row flex-center"},Me={class:"q-mr-md flex row flex-center"},He={class:"q-mt-md"},Oe={key:0,class:"absolute-top-left flex flex-center",style:{width:"100%",height:"100%"}},Le=b("i",{class:"fa fa-thumbtack",style:{transform:"rotate(45deg)"}},null,-1),Ee=b("i",{class:"fa fa-thumbtack absolute-top-left",style:{transform:"rotate(45deg)"}},null,-1),je={class:"flex flex-center"};function Re(s,a,i,k,e,n){return g(),S("div",Fe,[b("div",Ie,[b("div",Ne,[o(C,{dense:"",dark:e.theme==="dark",color:"grey-8",icon:"add",class:"q-ml-md q-mb-sm",onClick:n.newTask},null,8,["dark","onClick"]),o(C,{dense:"",dark:e.theme==="dark",color:"grey-8",icon:"category",class:"q-ml-md q-mb-sm",onClick:n.newCategory},null,8,["dark","onClick"]),b("div",Me,[(g(!0),S(H,null,O(e.filterBarOptions,(t,r)=>(g(),w(ae,{outlined:"",dark:e.theme==="dark",key:r,modelValue:e.filters[t.value],"onUpdate:modelValue":[f=>e.filters[t.value]=f,n.filterTasks],options:t.options,label:t.label,class:"t-select q-ml-md v-tasks q-mb-sm",color:e.theme==="dark"?"white":"dark",dense:"","label-color":e.theme==="dark"?"grey-7":"grey-9",style:J("width: "+r==1?170:70+"px")},null,8,["dark","modelValue","onUpdate:modelValue","options","label","color","label-color","style"]))),128))]),o(ue,{dense:"",dark:e.theme==="dark",outlined:"",color:e.theme==="dark"?"white":"dark",debounce:"200",modelValue:e.filters.search,"onUpdate:modelValue":[a[0]||(a[0]=t=>e.filters.search=t),n.filterTasks],placeholder:s.$t("pages.tasks.inputs.labels.search_task"),class:"q-mr-md q-mb-sm","label-color":e.theme==="dark"?"grey-7":"grey-9"},{append:l(()=>[o(T,{name:"search"})]),_:1},8,["dark","color","modelValue","placeholder","onUpdate:modelValue","label-color"])])]),b("div",He,[o(se,{dark:e.theme==="dark",color:e.theme==="dark"?"grey-7":"grey-9",modelValue:e.filters.showArchives,"onUpdate:modelValue":[a[1]||(a[1]=t=>e.filters.showArchives=t),n.filterTasks],label:s.$t("pages.tasks.inputs.labels.show_archiveds"),dense:"",class:v({"text-dark":e.theme!=="dark"})},null,8,["dark","color","modelValue","label","class","onUpdate:modelValue"]),o(se,{dark:e.theme==="dark",color:e.theme==="dark"?"grey-7":"grey-9",modelValue:e.filters.showEndeds,"onUpdate:modelValue":[a[2]||(a[2]=t=>e.filters.showEndeds=t),n.filterTasks],label:s.$t("pages.tasks.inputs.labels.show_finalizeds"),dense:"",class:v({"q-ml-xl":!0,"text-dark":e.theme!=="dark"})},null,8,["dark","color","modelValue","label","class","onUpdate:modelValue"])]),b("div",{style:{height:"58vh",overflow:"auto",position:"relative"},class:v({"tasks-grid":!0,"q-pl-md":!0,"q-pr-md":!0,"t-light":e.theme!=="dark"})},[e.rows.length===0?(g(),S("div",Oe,[b("div",{class:v({"text-h4":!0,"text-grey-7":e.theme==="dark","text-grey-6":e.theme!=="dark"})},y(s.$t("pages.tasks.titles.nothing_to_show")),3)])):F("",!0),(g(!0),S(H,null,O(e.rows,t=>(g(),S("div",{key:t.id,style:{position:"relative",height:"320px",width:"100%"},class:v({"q-mt-md":!0,"q-mb-sm":!0,flex:!0,"flex-center":!0,"task-archived":t.status==="archived"})},[o(Z,{dark:e.theme==="dark",class:v(e.theme==="dark"?"bg-grey-10":"bg-grey-5"),style:{height:"100%",width:"100%"}},{default:l(()=>[o(Q,{class:v({"bg-grey-8":e.theme==="dark","bg-grey-6":e.theme!=="dark",row:!0})},{default:l(()=>[o(x,{style:{"font-size":"13px"}},{default:l(()=>[q(y(t.title.length>40?t.title.substring(0,40)+"...":t.title),1)]),_:2},1024),t.fixed&&t.status!=="ended"?(g(),w(C,{key:0,flat:"",color:e.theme==="dark"?"grey-5":"grey-8",dense:"",rounded:"",class:"absolute-top-right q-mt-sm",style:{"margin-right":"40px"},onClick:r=>n.assingTask(t.id,!t.fixed)},{default:l(()=>[o(T,null,{default:l(()=>[Le]),_:1})]),_:2},1032,["color","onClick"])):F("",!0),t.status==="ended"?(g(),w(C,{key:1,flat:"",color:"green-5",dense:"",rounded:"",class:"absolute-top-right q-mt-sm",style:{"margin-right":"40px","pointer-events":"none"}},{default:l(()=>[o(T,{name:"check"})]),_:1})):F("",!0),o($e,{class:"absolute-top-right q-mr-xs q-mt-sm",flat:"",dense:"",rounded:"",color:e.theme==="dark"?"grey-5":"grey-8","dropdown-icon":"more_vert"},{default:l(()=>[o(ce,null,{default:l(()=>[L((g(),w(N,{clickable:"",dark:e.theme==="dark",onClick:r=>n.showTask(t),class:v(e.theme==="dark"?"bg-grey-9":"bg-grey-6")},{default:l(()=>[o($,null,{default:l(()=>[o(x,null,{default:l(()=>[o(T,{name:"visibility",color:e.theme==="dark"?"grey-5":"grey-9",class:"q-mr-md",size:"sm"},null,8,["color"]),q(y(s.$t("pages.tasks.titles.view_task")),1)]),_:1})]),_:1})]),_:2},1032,["dark","onClick","class"])),[[E],[R]]),L((g(),w(N,{dark:e.theme==="dark",clickable:"",onClick:r=>n.archiveTask(t.id),class:v(e.theme==="dark"?"bg-grey-9":"bg-grey-6")},{default:l(()=>[o($,null,{default:l(()=>[o(x,null,{default:l(()=>[o(T,{name:"archive",color:e.theme==="dark"?"grey-5":"grey-9",class:"q-mr-md",size:"sm"},null,8,["color"]),q(y(s.$t("pages.tasks.titles.archive")),1)]),_:1})]),_:1})]),_:2},1032,["dark","onClick","class"])),[[E],[R]]),L((g(),w(N,{dark:e.theme==="dark",clickable:"",onClick:r=>n.assingTask(t.id,!t.fixed),class:v(e.theme==="dark"?"bg-grey-9":"bg-grey-6")},{default:l(()=>[o($,null,{default:l(()=>[o(x,null,{default:l(()=>[o(T,{name:"keep_on",color:e.theme==="dark"?"grey-5":"grey-9",class:"q-mr-md",size:"sm"},{default:l(()=>[Ee]),_:1},8,["color"]),q(y(t.fixed?s.$t("pages.tasks.titles.unassign_task"):s.$t("pages.tasks.titles.assign_task")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["dark","onClick","class"])),[[E],[R]]),L((g(),w(N,{dark:e.theme==="dark",clickable:"",onClick:r=>n.deleteTask(t.id),class:v(e.theme==="dark"?"bg-grey-9":"bg-grey-6")},{default:l(()=>[o($,null,{default:l(()=>[o(x,{class:"text-red-5"},{default:l(()=>[o(T,{name:"delete",color:"red-5",class:"q-mr-md",size:"sm"}),q(y(s.$t("pages.tasks.titles.delete")),1)]),_:1})]),_:1})]),_:2},1032,["dark","onClick","class"])),[[E],[R]])]),_:2},1024)]),_:2},1032,["color"])]),_:2},1032,["class"]),o(te,{dark:e.theme==="dark"},null,8,["dark"]),o(Q,{class:"flex row"},{default:l(()=>[b("div",{class:v({"q-mr-sm":!0,"text-dark":e.theme!=="dark"})},y(s.$t("pages.tasks.titles.categories"))+": ",3),(g(!0),S(H,null,O(t.categories.slice(0,3),r=>(g(),w(_e,{key:r.id,label:r.name,style:J("background-color: #"+r.color+" !important"),class:"q-mr-xs",dense:""},{default:l(()=>[o(T,{name:r.icon,color:"white",class:"q-ml-xs"},null,8,["name"])]),_:2},1032,["label","style"]))),128))]),_:2},1024),o(Q,null,{default:l(()=>[o(x,{class:"row"},{default:l(()=>[b("div",{class:v({"q-mr-sm":!0,"text-white":e.theme==="dark","text-dark":e.theme!=="dark"})},y(s.$t("pages.tasks.titles.priority"))+": ",3),b("div",{class:v({"text-grey-7":t.priority.weight<3&&t.status!=="ended","text-red-5":t.priority.weight===4&&t.status!=="ended","text-orange-5":t.priority.weight===3&&t.status!=="ended","text-green-5":t.status==="ended"})},y(t.priority.weight>3&&t.status!=="ended"?s.$t("pages.tasks.messages.urgent_task"):" "+e.priorities[t.priority.name].name)+" "+y(t.status==="ended"?` (${s.$t("pages.tasks.titles.finalized")})`:""),3)]),_:2},1024)]),_:2},1024),o(te,{dark:e.theme==="dark"},null,8,["dark"]),o(Q,null,{default:l(()=>[o(x,{style:{"user-select":"text"},class:v({"text-dark":e.theme!=="dark"})},{default:l(()=>[q(y(t.description.length>240?t.description.substring(0,240)+"...":t.description),1)]),_:2},1032,["class"])]),_:2},1024),o(Q,{class:v({"absolute-bottom-right":!0,"text-grey-7":t.status!=="ended","text-green-5":t.status==="ended"}),style:{"margin-bottom":"-12px"}},{default:l(()=>[o(x,null,{default:l(()=>[q(y(s.$t("pages.tasks.titles.scheduled_for")),1)]),_:1}),o(x,{class:"flex row flex-center"},{default:l(()=>[o(T,{name:"calendar_today",class:"q-mr-sm q-mb-xs"}),q(y(t.isoDate),1)]),_:2},1024)]),_:2},1032,["class"]),o(Q,{class:v({"absolute-bottom-left":!0,"text-grey-7":e.theme==="dark","text-dark":e.theme!=="dark"}),style:{"margin-bottom":"-12px"}},{default:l(()=>[o(x,null,{default:l(()=>[q(y(s.$t("pages.tasks.titles.created_at")),1)]),_:1}),o(x,{class:"flex row flex-center"},{default:l(()=>[o(T,{name:"calendar_today",class:"q-mr-sm q-mb-xs"}),q(y(t.isoCreatedAt),1)]),_:2},1024)]),_:2},1032,["class"])]),_:2},1032,["dark","class"])],2))),128))],2),b("div",je,[e.totalTasks>e.filters.limit&&e.rows.length>0?(g(),w(Ce,{key:0,modelValue:e.filters.page,"onUpdate:modelValue":a[3]||(a[3]=t=>e.filters.page=t),max:Math.ceil(e.totalTasks/e.filters.limit),color:"grey-8",dark:e.theme==="dark",class:v({"q-mt-md":!0,"text-dark":e.theme==="dark","text-white":e.theme!=="dark"}),onClick:n.filterTasks},null,8,["modelValue","max","dark","class","onClick"])):F("",!0),o(ae,{modelValue:e.filters.limit,"onUpdate:modelValue":a[4]||(a[4]=t=>e.filters.limit=t),options:e.rowsPerPageOptions,dark:e.theme==="dark",style:{"min-width":"100px"},dense:"",color:e.theme==="dark"?"white":"dark",class:"q-ml-xl q-mt-md","label-color":"grey-7"},null,8,["modelValue","options","dark","color"])])])}var Ge=Y(Pe,[["render",Re]]);const Je={category_name:/^[a-zA-Z0-9 ]{1,50}$/,category_color:/^[0-9A-Fa-f]{6}$/,category_icon:/^[a-zA-Z0-9_]{1,20}$/},Ke={name:"CategoriesComponent",props:{show:Boolean,_theme:String},emits:["update:show"],data(s){const a=u(s._theme),i=u(!1),k=K(),e=u([]),n=u(s.show),t=u(!1),r=u(""),f=u({name:"",color:"",icon:""}),m=u({category_name:!0,category_color:!0,category_icon:!0}),h=[{label:this.$t("pages.tasks.inputs.labels.category_name"),prop:"name",type:"text",rule:"category_name","error-message":this.$t("pages.tasks.messages.invalid_category_name"),limit:50},{label:this.$t("pages.tasks.inputs.labels.category_color"),prop:"color",type:"text",rule:"category_color","error-message":this.$t("pages.tasks.messages.invalid_category_color"),limit:6},{label:this.$t("pages.tasks.inputs.labels.category_icon"),prop:"icon",type:"text",rule:"category_icon","error-message":this.$t("pages.tasks.messages.invalid_category_icon"),limit:20}];X(()=>{M().then(({data:p,status:d})=>{d===200&&(e.value=p.categories)})}),G(()=>s.show,p=>{n.value=p}),G(()=>s._theme,p=>{a.value=p});const B=p=>{for(const d in f.value){const V=Je["category_"+d];if(V&&!V.test(f.value[d])){m.value["category_"+d]=!1;return}else m.value["category_"+d]=!0}r.value="",p?Te(p,f.value.name,f.value.color,f.value.icon).then(({status:d})=>{d===200?(M().then(({data:V,status:D})=>{D===200&&(e.value=V.categories,this.resetCategory(),this.$q.notify({message:this.$t("pages.tasks.messages.category_updated"),color:"green-5",position:"bottom-right",timeout:2e3}))}),t.value=!1):(console.log(d),r.value=this.$t("pages.tasks.messages.error_saving_category"))}).catch(d=>{r.value=d.message||this.$t("pages.tasks.messages.error")}):xe(f.value.name,f.value.color,f.value.icon).then(({status:d})=>{d===201?(M().then(({data:V,status:D})=>{D===200&&(e.value=V.categories,this.resetCategory(),this.$q.notify({message:this.$t("pages.tasks.messages.category_saved"),color:"green-5",position:"bottom-right",timeout:2e3}))}),t.value=!1):r.value=this.$t("pages.tasks.messages.error_saving_category")}).catch(d=>{r.value=d.message||this.$t("pages.tasks.messages.error")}),this.selectedId=null},_=p=>{Be(p).then(({status:d})=>{d===200?M().then(({data:V,status:D})=>{D===200&&(e.value=V.categories,this.$q.notify({message:this.$t("pages.tasks.messages.category_deleted"),color:"green-5",position:"bottom-right",timeout:2e3}))}):r.value=this.$t("pages.tasks.messages.error_deleting_category")}).catch(d=>{r.value=d.message||this.$t("pages.tasks.messages.error")})},U=p=>{k.dialog({title:this.$t("pages.tasks.titles.confirm_delete_category"),message:this.$t("pages.tasks.messages.confirm_category_delete"),dark:!0,ok:{label:this.$t("pages.tasks.buttons.yes"),color:"red-5"},cancel:{label:this.$t("pages.tasks.buttons.no"),color:"grey-8"}}).onOk(()=>{_(p)})};return{theme:a,selectedId:u(0),categories:e,showCategories:n,inputs:h,valids:m,category:f,newCategory:t,error:r,saveCategory:B,saveType:u("new"),deleteThisCategory:_,confirmDelete:U,editing:i}},methods:{editCategory(s){this.selectedId=s.id,this.category.name=s.name,this.category.color=s.color,this.category.icon=s.icon,this.editing=!0,this.newCategory=!0},resetCategory(){this.category.name="",this.category.color="",this.category.icon=""}}},We={class:"text-h6"},Ze={class:"row"},Xe={class:"text-h6"};function Ye(s,a,i,k,e,n){return g(),w(ve,{persistent:"",modelValue:e.showCategories,"onUpdate:modelValue":a[4]||(a[4]=t=>e.showCategories=t),dark:e.theme==="dark"},{default:l(()=>[e.newCategory?(g(),w(Z,{key:1,dark:e.theme==="dark",style:{"min-width":"80%",position:"relative",height:"100%","max-height":"80vh"},class:"q-mt-xl"},{default:l(()=>[o(C,{flat:"",rounded:"",dense:"",icon:"close",class:"absolute-top-right q-mr-xs q-mt-xs",color:e.theme==="dark"?"white":"dark",onClick:a[2]||(a[2]=()=>{n.resetCategory(),e.newCategory=!1}),style:{"z-index":"99"}},null,8,["color"]),o(Q,{class:"flex"},{default:l(()=>[b("div",Xe,y(e.editing?s.$t("pages.tasks.titles.edit_category"):s.$t("pages.tasks.titles.new_category")),1)]),_:1}),o(Q,null,{default:l(()=>[e.error?(g(),w(Ue,{key:0,"inline-actions":"",class:"q-mb-md text-white bg-red-5",icon:"info",dense:"",rounded:""},{default:l(()=>[q(y(e.error),1)]),_:1})):F("",!0),(g(!0),S(H,null,O(e.inputs,t=>(g(),w(ue,{key:t.prop,modelValue:e.category[t.prop],"onUpdate:modelValue":r=>e.category[t.prop]=r,label:t.label,dense:"",dark:e.theme==="dark",maxlength:t.limit,color:e.theme==="dark"?"white":"dark",clearable:"",class:"q-mb-md","error-message":t["error-message"],error:!e.valids[t.rule]},null,8,["modelValue","onUpdate:modelValue","label","dark","maxlength","color","error-message","error"]))),128)),o(C,{label:e.editing?s.$t("pages.tasks.buttons.update"):s.$t("pages.tasks.buttons.save"),color:"grey-8",onClick:a[3]||(a[3]=t=>e.saveCategory(e.selectedId)),class:"q-mt-md"},null,8,["label"])]),_:1})]),_:1},8,["dark"])):(g(),w(Z,{key:0,dark:e.theme==="dark",style:{"min-width":"80%",position:"relative",height:"100%","max-height":"80vh"},class:"q-mt-xl"},{default:l(()=>[o(C,{flat:"",rounded:"",dense:"",icon:"close",class:"absolute-top-right q-mr-xs q-mt-xs",color:e.theme==="dark"?"white":"dark",onClick:a[0]||(a[0]=()=>{s.$emit("update:show",!1),e.showCategories=!1}),style:{"z-index":"99"}},null,8,["color"]),o(Q,{class:"flex"},{default:l(()=>[b("div",We,[q(y(s.$t("pages.tasks.titles.categories"))+" ",1),o(C,{class:"q-ml-md q-pl-xs q-pr-xs q-pt-none q-pb-none",size:"sm",color:"grey-8",icon:"add",onClick:a[1]||(a[1]=()=>{e.newCategory=!0,e.editing=!1})})])]),_:1}),o(Q,{style:{overflow:"auto","max-height":"60vh"}},{default:l(()=>[o(ce,null,{default:l(()=>[(g(!0),S(H,null,O(e.categories,t=>(g(),w(N,{key:t.name,class:v({"q-mb-sm":!0,"category-item-hover":!0,"t-light":e.theme==="light"})},{default:l(()=>[o($,null,{default:l(()=>[b("div",Ze,[o(T,{name:t.icon.toLowerCase()||"folder",style:J("color: #"+t.color),size:"sm"},null,8,["name","style"]),o(x,{class:"q-ml-md text-h6",style:J("color: #"+t.color)},{default:l(()=>[q(y(t.name),1)]),_:2},1032,["style"])])]),_:2},1024),o($,{side:""},{default:l(()=>[b("div",null,[o(C,{flat:"",dense:"",icon:"edit",onClick:r=>n.editCategory(t)},null,8,["onClick"]),o(C,{flat:"",dense:"",color:"red-5",icon:"delete",onClick:r=>e.confirmDelete(t.id)},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1},8,["dark"]))]),_:1},8,["modelValue","dark"])}var es=Y(Ke,[["render",Ye]]);const ss=ye({name:"TasksPage",mounted(){K().loading.hide()},setup(){const s=u(z.get("theme")),a=u(z.get("configurations")),i=new me(()=>{s.value=z.get("theme"),a.value=z.get("configurations")});i.start(),de(()=>{i.stop()});const k=K(),e=u(!1),n=u(!1);return{configurations:a,theme:s,showForm:e,showTask:n,showMessage:(t,r)=>{const f={success:{color:"positive",icon:"verified"},error:{color:"negative",icon:"error"},warning:{color:"warning",icon:"warning"},info:{color:"info",icon:"notification_important"}},{color:m,icon:h}=f[t],[B,_,U,p,d]=["white","bottom-right",!0,null,1500];k.notify({color:m,icon:h,textColor:B,position:_,message:r,multiline:U,actions:p,timeout:d})},task:u({}),showNewCategoryForm:u(!1)}},components:{QuasarTableComponent:Ge,NewTaskComponent:Ve,TaskComponent:Qe,CategoriesComponent:es},methods:{showNewTaskForm(){this.showForm=!0},saveTask(){this.showForm=!1,this.showMessage("success","Task saved successfully")},archivedTaskHandler(s){let a=s.length>1?"s":"";s.length>0?this.showMessage("info",`Task${a} archived successfully`):this.showMessage("warning","No tasks selected")},deletedTaskHandler(s){let a=s.length>1?"s":"";s.length>0?this.showMessage("info",`Task${a} deleted successfully`):this.showMessage("warning","No tasks selected")},handleShowTask(s){this.task=s,this.showTask=!0},showFixedTasks(){I.emit("show-fixed-tasks")}}}),ts={id:"t-tasks-content"},as=b("i",{class:"fa fa-thumbtack",style:{transform:"rotate(45deg)"}},null,-1);function os(s,a,i,k,e,n){const t=j("NewTaskComponent"),r=j("CategoriesComponent"),f=j("QuasarTableComponent"),m=j("TaskComponent");return g(),w(be,{class:"flex",style:{height:"100%",overflow:"auto"}},{default:l(()=>[b("div",ts,[o(t,{show:s.showForm,"onUpdate:show":a[0]||(a[0]=h=>s.showForm=h),"onUpdate:save":s.saveTask,_theme:s.theme,_configurations:s.configurations},null,8,["show","onUpdate:save","_theme","_configurations"]),o(r,{show:s.showNewCategoryForm,"onUpdate:show":a[1]||(a[1]=h=>s.showNewCategoryForm=h),_theme:s.theme},null,8,["show","_theme"]),o(f,{"onUpdate:newtask":s.showNewTaskForm,"onUpdate:archivetask":s.archivedTaskHandler,"onUpdate:deletetask":s.deletedTaskHandler,"onUpdate:showtask":s.handleShowTask,"onUpdate:newcategory":a[2]||(a[2]=h=>s.showNewCategoryForm=h)},null,8,["onUpdate:newtask","onUpdate:archivetask","onUpdate:deletetask","onUpdate:showtask"]),o(m,{_theme:s.theme,task:s.task,"onUpdate:show":a[3]||(a[3]=h=>s.showTask=!1),"onUpdate:edittask":a[4]||(a[4]=()=>{s.showForm=!0,s.showTask=!1}),show:s.showTask},null,8,["_theme","task","show"]),o(C,{color:"grey-7",dark:"",size:"md",class:"fixed-bottom-right q-mr-md q-mb-md",onClick:s.showFixedTasks},{default:l(()=>[as]),_:1},8,["onClick"])])]),_:1})}var ys=Y(ss,[["render",os]]);export{ys as default};
